<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@500&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
        rel="stylesheet">

    <title>JustCookIT</title>
</head>

<body>
    <header>
        <div class="segundo_wrap header__wrapper">
            <div class="header__sections">
                <div class="header__section-upper">
                    <div class="logo">
                        <h1>JustCookIT</h1>
                    </div>
                    <nav>
                        <ul>
                            <li><a href="#About_us">About us</a></li>
                            <li><a href="#How_it_works">Easy to start here</a></li>
                            <li><a href="#A_few_more">A few more</a></li>
                        </ul>
                    </nav>
                </div>
                <div class="header-section-slider">
                    <div class="header__areas areas__container">
                        <ul class="areas__slider slider">
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Canadian">Canadian</a>
                            </li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Dutch">Dutch</a></li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Egyptian">Egyptian</a>
                            </li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Filipino">Filipino</a>
                            </li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=French">French</a></li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Greek">Greek</a></li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Indian">Indian</a></li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=American">American</a>
                            </li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=British">British</a></li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Chinese">Chinese</a></li>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Croatian">Croatian</a>
                            </li </ul>
                            <li><a onclick="showFetchedMealsByArea(this.textContent, event)"
                                    href="https://www.themealdb.com/api/json/v1/1/filter.php?a=Russain">Russian</a></li
                                </ul>
                    </div>
                </div>
            </div>
        </div>
    </header>
    <main>
        <div class="wrap">
            <section id="About_us" class="section__container">
                <h1 class="section__title">About us</h1>
                <p class="section__text">
                    We are <span class="section__text-accent"><a href="#links_to_us">3 students</a></span> of the 2nd
                    year <span class="section__text-accent"><a
                            href="https://www.pef.czu.cz/cs/r-7008-studium/r-7021-studijni-programy/r-7484-bakalarske-studium/r-7626-informatika-info"
                            target=”_blank”>INFOP</a></span>.
                    This course project expands our knowledge in markup languages.</br>
                    It is forbidden to use side framework, libraries and other features for this web.
                    Everything you see here is designed using vanila <span class="section__text-accent"><a
                            href="https://developer.mozilla.org/en-US/docs/Web/HTML" target=”_blank”>HTML</a></span>,
                    <span class="section__text-accent"><a href="https://developer.mozilla.org/en-US/docs/Web/CSS"
                            target=”_blank”>CSS</a></span> and a bit of <span class="section__text-accent"><a
                            href="https://developer.mozilla.org/en-US/docs/Web/JavaScript"
                            target=”_blank”>magic</a></span>.
                    </br>So, let's see what is it... our "JustCookIT"
                </p>
            </section>
            <section id="How_it_works" class="section__container">
                <h1 class="section__title">How it works?</h1>
                <p class="section__text">
                    So, welcome to our website, here is a library of dishes from all over the world. Each time the page
                    is refreshed, the recipes at the bottom will be updated, so don't forget to rewrite them as soon as
                    possible (or at least rewrite the name). After you click on one of the tags at the top of the page,
                    a list of delicious dishes of this country will appear. We are glad to welcome you, and wish you a
                    pleasant appetite.</br>

                    Magic happens on this site, or as it is now called processing responses from the server. For these
                    magical transformations, we need the horn of a single unicorn, and the saliva of a beaver....</br>
                    No,
                    it's just an open API <span class="section__text-accent"><a href="https://www.themealdb.com/api.php"
                            target=”_blank”>https://www.themealdb.com/api.php</a></span>
                </p>
            </section>
            <section style="display: none;" id="meals" class="meals section__container">
                <h1 class="section__title">Try is next time</h1>
                <div id="meals_by_area" class="meals__container content_container">
                    <!-- Dynamical content -->


                    <!-- ----------------- -->
                    <div class="meals__item tag">
                        ${element}
                    </div>
                </div>
            </section>
            <section style="display: none;" id="recipes" class="recipes section_container">
                <h1 class="section__title">We found for you something</h1>
                <div id="fetched_recipes" class="recipes__container">
                    <!-- Dynamical content -->
                    <div class="recipe__item content_container">
                        <h3 class="recipe__item-title">
                            Burek
                        </h3>
                        <div class="recipe__item-instruction">
                            <p class="recipe__instruction">
                                Fry the finely chopped onions and minced meat in oil. Add the salt and pepper. Grease a
                                round baking tray and put a layer of pastry in it. Cover with a thin layer of filling
                                and cover this with another layer of filo pastry which must be well coated in oil. Put
                                another layer of filling and cover with pastry. When you have five or six layers, cover
                                with filo pastry, bake at 200ºC/392ºF for half an hour and cut in quarters and serve.
                            </p>
                        </div>
                        <hr />
                        <div class="recipe__item-tags">
                            <p class="recipe__item-tag tag">
                                Side
                            </p>
                            <p class="recipe__item-tag tag">
                                Croatian
                            </p>
                        </div>
                    </div>
                    <div class="recipe__item content_container" itemscope itemtype="https://schema.org/Recipe">
                        <h3 class="recipe__item-title" itemprop="name">
                            Burek
                        </h3>
                        <div class="recipe__item-instruction" itemprop="recipeInstructions">
                            <p class="recipe__instruction">
                                Fry the finely chopped onions and minced meat in oil. Add the salt and pepper. Grease a
                                round baking tray and put a layer of pastry in it. Cover with a thin layer of filling
                                and cover this with another layer of filo pastry which must be well coated in oil. Put
                                another layer of filling and cover with pastry. When you have five or six layers, cover
                                with filo pastry, bake at 200ºC/392ºF for half an hour and cut in quarters and serve.
                            </p>
                        </div>
                        <hr />
                        <div class="recipe__item-tags">
                            <p class="recipe__item-tag tag" itemprop="recipeCategory">
                                Side
                            </p>
                            <p class="recipe__item-tag tag" itemprop="recipeCuisine">
                                Croatian
                            </p>
                        </div>
                    </div>
                    <div class="recipe__item content_container">
                        <h3 class="recipe__item-title">
                            Spaghetti Carbonara
                        </h3>
                        <div class="recipe__item-instruction">
                            <p class="recipe__instruction">
                                Cook spaghetti according to package instructions.
                                In a separate bowl, whisk together eggs, grated Parmesan cheese, and black pepper.
                                In a skillet, cook diced pancetta until crispy.
                                Drain cooked spaghetti and immediately add to the skillet with pancetta, tossing to
                                combine.
                                Remove skillet from heat and quickly pour in egg mixture, stirring continuously until
                                eggs thicken but do not scramble.
                                Serve immediately with additional grated Parmesan cheese on top.
                            </p>
                        </div>
                        <hr />
                        <div class="recipe__item-tags">
                            <p class="recipe__item-tag tag">
                                Traditional
                            </p>
                            <p class="recipe__item-tag tag">
                                Italian
                            </p>
                        </div>
                    </div>
                    <!-- ----------------- -->
                </div>
            </section>
        </div>
    </main>
    <footer>
        <div class="segundo_wrap">
            <div id="links_to_us">
                <ul>
                    <li class="mailLink__item-member"><a href="mailto:xkagp001@studenti.czu.cz">Polina Kagarlykskaia</a>
                    </li>
                    <li class="mailLink__item-member"><a href="mailto:xeren003@studenti.czu.cz">Natalia Eremina</a></li>
                    <li class="mailLink__item-member"><a href="mailto:xelkn001@studenti.czu.cz">Nikita Elkin</a></li>
                </ul>
            </div>
        </div>
    </footer>
    <script>
        //TODO: maybe some count slider for count variable?
        async function fetchRandomRecipes(count = 5) {
            const container = document.getElementById('fetched_recipes'); // Assuming a container element

            try {
                const responses = []; // Array to store multiple fetch responses
                for (let i = 0; i < count; i++) {
                    const response = await fetch('https://www.themealdb.com/api/json/v1/1/random.php');
                    responses.push(response);
                }

                // Process each response and display data
                const recipeHtml = [];
                for (const response of responses) {
                    const data = await response.json();
                    const meal = data.meals[0];
                    // new fragment

                    let ingredientsHtml = '';
                    for (let i = 1; i <= 20; i++) {
                        const ingredient = meal[`strIngredient${i}`];
                        const measure = meal[`strMeasure${i}`];
                        if (ingredient && measure) {
                            ingredientsHtml += `<p itemprop="recipeIngredient" class="recipe__item-tag tag">${ingredient} - ${measure}</p>`;
                        }
                    }

                    // end of new fragmment 
                    recipeHtml.push(`
                    <div class="recipe__item content_container">
                        <h3 class="recipe__item-title">
                            ${meal.strMeal}
                        </h3>
                        <div class="recipe__item-instruction">
                            <p itemscope="recipeInstructions" class="recipe__instruction">
                                ${meal.strInstructions}
                            </p>
                        </div>
                        <div class="hide_container">
                            <hr/>
                            <div class="recipe__item-tags">
                                <p itemscope="recipeCategory" class="recipe__item-tag tag">
                                    ${meal.strCategory}
                                </p> 
                                <p itemscope="recipeCuisine" class="recipe__item-tag tag">
                                    ${meal.strArea}
                                </p>                   
                            </div>
                            <hr/>
                            <div class="recipe__item-tags slider">
                                ${ingredientsHtml}   
                            </div>
                        </div>
                    </div>
                    `);
                }
                container.innerHTML = recipeHtml.join(''); // Combine and display all recipes
            } catch (error) {
                console.error('Error fetching data:', error);
                container.innerHTML = '<h2>Error fetching recipes!</h2>';
            }
        }

        async function fetchMealsByAria(content, event) {
            event.preventDefault(); // block redirection after click

            try {
                console.log("Link content:", content); // log the content into console
                const mealsList = [];

                // fetching and handling
                const response = await fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?a=${content}`);
                const data = await response.json();

                if (data.meals) { // check if data.meals is not null
                    data.meals.forEach(meal => mealsList.push(meal.strMeal));
                } else {
                    console.log("No meals found."); // not found log
                }
                console.log(mealsList);

                const container = document.getElementById('meals_by_area');
                const mealsHtml = [];

                mealsList.forEach(element => {

                    mealsHtml.push(`
                    <div class="meals__item tag">
                        ${element}
                    </div>
                    `);
                })
                container.innerHTML = mealsHtml.join('');
                console.log("Meals List:", mealsList);

            } catch (error) {
                console.error("Error fetching data:", error);
            }
            document.getElementById('meals').style.display = "block";
        }

        function showFetchedMealsByArea(content, event) {
            event.preventDefault();
            if (navigator.onLine)
                fetchMealsByAria(content, event)
            else {
                window.alert("sorry, no connection...\n let's try nex time :)");
            }
        }


        fetchRandomRecipes(); // Call the function to fetch and display recipes
        document.getElementById('recipes').style.display = "block";

    </script>
</body>

</html>